---
title: "JavaScript·TypeScriptの基本知識・文法(未)"
date: "2023-05-16"
---

## TypeScript

### 静的型付け

-   TypeScript = JavaScript + 静的型システム
-   型システムは、変数や式、関数に型という特性を付加するための規則群から成立する論理的なシステム
-   静的とは、型検査をコンパイル時、インタプリタ時に行うという性質を示す
-   静的型付けとは、プログラムを実行する前に静的型検査を行うこと指す
-   静的型検査は、変数や式、関数に割り当てた型に不一致や矛盾(型エラー)があるかどうかを調べる
-   静的型検査は、ソースコードのテキストを解析することでプログラムの型安全性を検証するプロセス

### TypeScript

-   TypeScript は、静的型システムを備えているので変数や式、関数に割り当てた型はコンパイル時のみに使用される
-   つまり、TypeScript で付加した型は、プログラム実行時の挙動に影響を与えない
-   TypeScript は、静的型システムを備えているので、型に関連するエラーをコンパイル時に検出する
-   コンパイル時に検出するエラーは、構文エラー(syntax error)と型エラー(type error)

### TypeScript コンパイラ

-   TypeScript コンパイラは TypeScript プログラムに 対して、型チェックとトランスパイルを実行する

#### 型検査(Type check)

-   型検査は、型安全性の検証が静的に行われる
-   TypeScript では、型検査の際に必要となる型情報を変数や式に割り当てる型注釈を通して提供する

#### トランスパイル

-   TypeScript プログラムは、静的型付けによる型検査のみを役割とするため 、TypeScript プログラムを直接実行するということはない
-   そのため、TypeScript プログラムは JavaScript プログラムに変換する必要がある
-   この変換をトランスパイル、もしくはコンパイルと呼ぶ
-   コンパイルの意味は、ソースコードを CPU が解釈可能な形式に変換すること
-   TypeScript のトランスパイルは、以下２つの段階からなる
    -   型注釈の取り除き
    -   ターゲットの JavaScript に変換
-   型注釈の取り除きは、型をただ取り除くだけで型情報が参照されることはない
-   型情報が参照されないので、型によって変換結果が変わることはない
-   型情報は、もっぱら静的な型チェックのためだけに使用される
-   TypeScript プログラムは、型注釈を取り除いただけで JavaScript プログラムに変換されるが、さらに古いバージョンの JavaScript プログラムに変換される
-   この古い構文への変換は、古い実行環境でも新しい構文を実行可能にするために行われる

-   TypeScript コンパイラは、構文チェック＆静的型検査 → 型注釈の取り除き → 古い構文への変換の順番で実行する。

### TypeScript の実行環境

-   TypeScript コンパイラは、Node.js 上で動作可能なので Node.js をインストールする
-   `node -v`で、Node.js がインストールされているか確認
-   TypeScript コンパイラ(tsc)の設定は、コマンドライン引数で指定するか、tsconfig.json で指定するかの二通りの方法がある
-   以下では、tsconfig.json で tsc を設定する方法について説明する

1. TypeScript プロジェクトとなるディレクトリを用意する
2. `npm init --yes` を実行し、package.json を生成する
3. package.json に`"type": "module",`を追加する
4. `npm install --save-dev typescript @types/node`を実行する
5. .gitignore に`node_module/`を追加する
6. `npx tsc --init`を実行し、tsconfig.json を生成する
7. tsconfig.json の"compilerOptions"に以下のオプションを追加する
    - "target": "ES2020"
    - "module": "ESNext" (module に関する取り扱い)
    - "moduleResolution": "node"
    - "outDir": "./dist"
8. tsconfig.json の"include"オプションを"compilerOptions"の外側に追加する
    - "include": ["./src/**/*.ts"]
9. src/index.ts を作成する
10. `npx tsc`を実行すると自動的に tsconfig.json が読み込まれ、dist/index.js が生成される
11. `node dist/index.js `を実行する

### 基本型

-   基本型は、内部に構造を持たないデータ型
-   基本型は、文字列型、数値型、真偽値型、Bigint、null、undefined、シンボル型
-   文字列型は、UTF-16 コードを表す 16 ビットの符号なし整数値のシーケンスとしてエンコードされる
-   数値型は、IEEE 754 の倍精度浮動小数点形式の値
-   真偽値型には、値が true と false の２つしかない
-   基本型 undefined には、値が undefined の一つしかない
-   基本型 null には、値が null の一つしかない

#### 数値型(number)

-   数値型(number)は、整数と小数の区別がない
-   数値リテラルは、式の一種である
-   リテラルは、値を生成するための式
-   数値リテラルは、式なので計算結果をもつ
-   数値リテラルの計算結果は、数値そのものである

#### 文字列型(string)

-   文字列リテラルの書き方は、３種類ある

    -   '...' (シングルクォート)
    -   "..." (ダブルクォート)
    -   `...` (バッククォート)

-   バッククォートの文字列リテラルは、テンプレートリテラルと呼ばれる
-   テンプレートリテラルは、内部に式を埋め込むことができる

```ts
const str1: string = "Hello";
const str2: string = "World";
console.log(`${str1} ${str2}`);
```

#### 論理値型(boolean)

-   `true`,`false`は事前に定義された予約語
-   変数名の識別子として true,false を使用すると、エラーが出る。
-   true,false は真偽値リテラルである

### 型変換

#### 暗黙の型変換

-   演算子`+`の一方が文字列型の場合、もう一方のリテラルは文字列型に暗黙に変換される

```ts
const str1: string = "99";
console.log(str1 + 100);
// 99100
console.log(str1 + true);
// 99true
```

-   論理値型の文脈では、0,"",NaN,null,undefined は、false に型変換される

#### 明示的な型変換

```ts
const str1: string = "99";
console.log(Number(str1) + 100);
// 199
```

### 変数宣言

-   再代入が可能な変数宣言 let

```ts
let str: string = "Hello";
str = "World";
console.log(str);
// World
```

-   再代入が不可能な変数宣言 const

```ts
const str: string = "Hello";
str = "World"; // error
```

### 演算子

-   演算子は、式を組み合わせて新たな式を作り出す構文

#### 算術演算子・二項演算子

-   加算: +
-   減算: -
-   乗算: \*
-   除算: /
-   剰余: %
-   累乗: \*\*

```ts
console.log(17 + 8); // 25
console.log(17 - 8); // 9
console.log(17 * 8); // 136
console.log(17 / 8); // 2.125
console.log(17 % 8); // 1
console.log(17 ** 8); // 6975757441
```

#### 算術演算子・単項演算子

-   (+)
-   (-)
-   (++)
-   (--)

-   インクリメント・デクリメントは、変数の値を書き換えるという副作用のために式文として使用される事が多い
-   副作用とは、式の計算結果を返り値として返す以外に発生する影響のこと

#### 文字列の連結 演算子 +

-   テンプレートリテラルで代用される事が多いので、あまり使用されない

#### 比較演算子

-   (<)
-   (>)
-   (<=)
-   (>=)

#### 等価演算子

-   (===)
-   (!==)
-   (==)
-   (!=)

-   比較演算子と等価演算子の返り値は、必ず真偽値
-   (===),(!==)を基本的に使用する

#### 論理演算子

-   (&&)
-   (||)

```ts
x && y;
x || y;
```

-   左側オペランド x を真偽値型に変換した結果によって、`x && y `,`x || y`の式全体の計算結果が決まる
-   等価演算子・比較演算子のように、演算子&&,||が真偽値だけを返すわけではない

```ts
console.log(0 && 123); // 0
console.log(123 && "Hello"); // Hello
```

```ts
console.log(0 || 123); // 123
console.log(123 || "Hello"); // 123
```

-   左側オペランド x を真偽値型に変換した結果`true`だった場合、短絡評価が行われる
-   短絡評価とは、左側オペランド x を式全体の返り値として返すと決まった場合、右オペランドの式は評価されないという意味
-   評価とは、式を実行し値を得ること

#### 論理演算子 ??

```ts
x ?? y;
```

-   ??演算子は、x が`null`または`undefined`の場合、y を式全体の返り値として返し、それ以外の場合は x を返すという働きを持つ
-   x にデータが格納されない可能性がある状況でよく使用される

#### 条件演算子

```ts
x ? y : z;
```

-   条件式 x の計算結果が`true`の場合,y を返す
-   条件式 x の計算結果が`false`の場合,z を返す

#### 代入演算子

-   代入演算子`=`は、変数に値を代入するという副作用を目的に使用される

### 制御構文

#### if

#### for

#### switch

#### while

-

### 合成型(オブジェクト型)

-   合成型は、内部に構造を持つデータ型、つまり基本型を内部に持つ型
-   合成型は、オブジェクト型
-   オブジェクトには、ただのオブジェクトと配列と関数がある

#### オブジェクト

-   オブジェクトは、基本型の値を構成要素にもつ連想配列
-   オブジェクトの各要素は、プロパティと呼ばれ、名前で区別される
-   基本的に、オブジェクトはオブジェクトリテラルで生成する

```ts
const user = { username: "yamada", age: 33 }; // オブジェクトリテラル
console.log(user); // { username: 'yamada', age: 33 }
```

-   プロパティは、プロパティアクセスで取得する

```ts
const user = { username: "yamada", age: 33 };
console.log(user.username); // usernameプロパティにアクセス
console.log(user.age); // ageプロパティにアクセス
```

#### 省略記法

```ts
const username: string = "yamada";
const age: number = 33;

const user = { username, age };
console.log(user);
```

-   プロパティ名と変数名が同じ場合は、オブジェクトリテラルに変数名のみを指定することが可能

#### スプレッド構文

```ts
const user2022 = { username: "yamada", age: 33 };
const user2023 = { ...user2022, age: 34 };
console.log(user2023);
```

-   `...オブジェクト`をオブジェクトリテラル内部に組み込むことで、対象のオブジェクトに自身のコピーを生成
-   コピーしたオブジェクトと同じプロパティを後に指定した場合、後に指定したプロパティが優先される

#### type 文で型に別名をつける

#### interface 宣言でオブジェクト型を宣言

#### オプショナルなプロパティ

#### 読み込み専用プロパティ

#### typeof キーワード

### 部分型関係

#### 型引数

### 配列

#### 配列リテラル

#### 配列の型

#### 配列関連の様々なメソッド

### 分割代入

#### オブジェクトの分割代入

#### 配列の分割代入

### その他の組み込みオブジェクト

## TypeScript の関数

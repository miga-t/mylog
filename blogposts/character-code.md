---
title: "文字コードの基礎知識"
date: "2023-05-10"
---

### 文字集合

-   文字集合は、システム扱おうと考えている文字の集合
    -   文字を符号化する際に必要な文字の種類を事前に決めておく必要がある。この文字の種類を重複なく集めたものが文字集合。
    -   例えば、五十音図上の「ひらがな」のみを扱うシステムの場合、文字集合は 48 字の「ひらがな」。
    -   英数字、その他の記号が必要な場合、文字集合は ASCII の 128 個の記号。

### 文字コード

-   文字コードは、文字集合の上に成り立つもの
-   文字集合を定義し、その各文字にビット列を一意に定めたものを、文字コードと呼ぶ
-   文字コードは、符号化文字集合とも呼ばれる。
-   符号化（コード化）とは、文字からコード(ビット列)に変換すること。
-   文字コード表は、符号化文字集合を見やすくしたもの
-   以下は ASCII の文字コード表

![ASCII](https://storage.googleapis.com/mylog13/USASCII_code_chart.png)

-   例えば、`A`は上位 3 ビット(b7~b5)が`0x4`,下位 4 ビット(b4~b1)が`0x1`なので、`A`は`0x41`に符号化される。

-   例えば、7 列目 8 行目に`x`が対応するので、`x`は`7/8`に位置する。`7/8`はコードポイント。
-   コードポイントは、文字コード表中の位置のこと
-   コードポイントは、コードポジション、符号位置とも呼ばれる。
-   コードポイントは、コード（一意の番号)を指すときにも使用されるので、`x`のコードポイントは`0x78`とも呼ばれる。
-   ASCII では、大文字のアルファベットが小文字のアルファベットとちょうど 2 列分(`0x20`,`32`)離れて位置している
-   つまり、大文字-小文字間の変換は`32`の足し引きで実現できる。実際のプログラミングでは大文字-小文字間の変換の実装はよく行われる。
-   画面上では`Hello World`と表示されていても、ファイルに保存される時はそれぞれの文字が対応するビット列に変換されて保存される。
-   `Hello World`のバイト列は以下

```
48 65 6c 6c 6f 20 57 6f 72 6c 64 (16進数のバイト列)
```

```
1001000 1100101 1101100 1101100 1101111 100000 1010111 1101111 1110010 1101100 1100100 (２進数のバイト列)
```

-   バイト列は、ビットの羅列はバイト毎に分割して並べたもの。

    -   データは、メモリ上でバイトごとに格納される。
    -   データ（数値、文字列、論理値)は、各データの単位で区切って格納される。この各データごとの単位が型である。(?)
    -   上記のようなビット列に型という情報を付加しないと、ただのビットの羅列である。

-   文字化けは、符号化されたコードを別の文字コードで復号化（文字化）したときに起こる現象

### Unicode UTF-8

-   Unicode は、世界中の文字を一つの文字集合に収めた文字コード
-   Unicode の文字集合の符号空間は 0 - 10FFFF16 で、111 万 4,112 の符号位置(コードポイント)がある。
-   Unicode の符号位置は、接頭辞`U+`をつけた 4~6 桁の 16 進数の非負整数
-   U+4E00 は、基本多言語面(BMP,群 00 面 00)の区 4E 点 00 に位置する。このコードポイントに位置する文字は、「一」
-   Unicode で定められたコードポイント(U+4E00)をそのままビット列で表して使用するのではなく、一定の手順で特定の形式に変換する。
-   この変換方式が、文字符号化方式（文字エンコーディング）、または文字符号化スキームと呼ばれる。
-   UTF-8 は、Unicode の符号位置をコンピュータが利用できるバイト列に変換する文字符号化方式
-   UTF-8 は、Unicode の符号位置をを 8 ビット単位のバイト列に変換する方式
-   UTF-16,UTF-32 は、それぞれ 16 ビット単位,32 ビット単位のバイト列に変換する方式
-   UTF-8 は、コードポイントが U+7F までなら変換せず 8bit で、それ以降は値に応じて 16 ～ 48bit に変換
-   11111111(2) = FF(16) = 255(10) = 1byte 分のデータ
-   Unicode といえば UTF-8 でエンコードされたデータを意味することが多い。
-   コードポイント「U+30A2」のカタカナ「ア」を、以下の UTF-8 変換表で変換する

    -   `30A2`は、２進数で`11000010100010`
    -   `11000010100010`を３行目の x に右詰めで当てはめると、`11100011 10000010 10100010`
    -   `e3 82 a2`のバイト列が得られる

![A link](https://storage.googleapis.com/mylog13/ngrAq.png)

-   Go 言語では、string 型の値を rune 型のスライスに変換すると、Unicode のコードポイント(10 進数)が得られる。
-   Go 言語では、string 型の値を byte 型のスライスに変換すると、UTF-8 のコード値(バイト列)が得られる。

```go
var str string = "ア"
fmt.Println([]rune(str)) //[12450] (16進数で 30A2)
fmt.Println([]byte(str)) //[227 130 162] (16進数で e3 82 a2)
```

-   Unicode は、Unicode コンソーシアムが策定・改訂したもの
-   ISO/IEC 10646 は、ISO/IEC が策定した国際標準規格。
-   ISO/IEC 10646 が定義する文字コードを UCS とよぶ
-   UCS と Unicode は同じもの
-   UCS-4 は、符号位置が 4 バイトで定義されていて上位のバイトから 1 バイト毎に群・面・区・点と呼ばれている
-   UCS-2 は、UCS-4 の群 00 の面 00 の基本多言語面(BMP)として定義されている

## 参考

[Unicode - Wikipedia](https://ja.wikipedia.org/wiki/Unicode)

[Unicode とは - 意味をわかりやすく](https://e-words.jp/w/Unicode.html)

[文字コード](https://so-zou.jp/software/tech/programming/tech/character-code/#unicode)
